<section class="my-4 mx-auto flex flex-col items-center">
  <div class="space-y-12 w-full">
    <!-- Working Experience & Education -->
    <div>
      <div class="section-header">Working Experience & Education</div>
      <div class="relative flex items-center">
        <button class="scroll-btn scroll-btn-left" onclick="scrollLeftAction('work')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"></polyline>
          </svg>
        </button>
        <div id="work"
          class="flex overflow-x-auto space-x-2 sm:space-x-4 scrollbar-hide w-full mx-auto transition-all duration-300 justify-start py-4">
          {{ range .Site.Params.homepage.resume.work }}
          <div role="button" tabindex="0" aria-label="Mehr zu {{ .name }}"
            class="flex-shrink-0 w-64 max-w-xs sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/5 2xl:w-1/6 text-center resume-entry cursor-pointer resume-card transition-all duration-300 ease-in-out"
            onclick="window.resumeModal(`<div class='flex flex-col items-center mb-4'>
              <div class='image-container mb-2'><img src='{{.logo}}' alt='{{.name}} Logo'></div>
            </div>
            <div>{{ .details | safeHTML }}</div>`);" onkeydown="if(event.key==='Enter'||event.key===' '){window.resumeModal(`<div class='flex flex-col items-center mb-4'>
              <div class='image-container mb-2'><img src='{{.logo}}' alt='{{.name}} Logo'></div>
            </div>
            <div>{{ .details | safeHTML }}</div>`);}">
            <div class="image-container">
              <img src="{{.logo}}" alt="{{.name}} Logo">
            </div>
            <p class="my-1 font-bold leading-tight text-base sm:text-lg md:text-xl lg:text-lg xl:text-base">{{.role}}
            </p>
            {{ if .role2 }}<p class="my-1 font-light text-sm">{{.role2}}</p>{{ end }}
            {{ if .role3 }}<p class="my-1 font-light text-sm">{{.role3}}</p>{{ end }}
            <p class="text-gray-500 my-1">{{.duration}}</p>
          </div>
          {{ end }}
        </div>
        <button class="scroll-btn scroll-btn-right" onclick="scrollRightAction('work')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9,18 15,12 9,6"></polyline>
          </svg>
        </button>
      </div>
    </div>

    <!-- Skills -->
    <div>
      <div class="section-header">Skills & Tools</div>
      <div class="relative flex items-center">
        <button class="scroll-btn scroll-btn-left" onclick="scrollLeftAction('skills')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"></polyline>
          </svg>
        </button>
        <div id="skills"
          class="flex overflow-x-auto space-x-2 sm:space-x-4 scrollbar-hide w-full mx-auto transition-all duration-300 justify-start py-4">
          {{ range .Site.Params.homepage.resume.skills }}
          <div role="button" tabindex="0" aria-label="Mehr zu {{ .name }}"
            class="flex-shrink-0 w-64 max-w-xs sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/5 2xl:w-1/6 text-center cursor-pointer resume-card transition-all duration-300 ease-in-out"
            onclick="window.resumeModal(`<div class='flex flex-col items-center mb-4'>
              <div class='image-container mb-2'><img src='{{.image}}' alt='{{.name}} Image'></div>
              <div class='my-1 font-bold leading-tight text-base sm:text-lg md:text-xl lg:text-lg xl:text-base'>{{.name}}</div>
              {{ if .description }}<p class='my-1 font-light text-sm leading-tight'>{{.description}}</p>{{ end }}
            </div>
            <div>{{ .details | safeHTML }}</div>`);" onkeydown="if(event.key==='Enter'||event.key===' '){window.resumeModal(`<div class='flex flex-col items-center mb-4'>
              <div class='image-container mb-2'><img src='{{.image}}' alt='{{.name}} Image'></div>
              <div class='my-1 font-bold leading-tight text-base sm:text-lg md:text-xl lg:text-lg xl:text-base'>{{.name}}</div>
              {{ if .description }}<p class='my-1 font-light text-sm leading-tight'>{{.description}}</p>{{ end }}
            </div>
            <div>{{ .details | safeHTML }}</div>`);}">
            <div class="image-container">
              <img src="{{.image}}" alt="{{.name}} Image">
            </div>
            <div class="my-1 font-bold leading-tight text-base sm:text-lg md:text-xl lg:text-lg xl:text-base">{{.name}}
            </div>
            <p class="my-1 font-light text-sm leading-tight" v-if=".description">{{.description}}</p>
          </div>
          {{ end }}
        </div>
        <button class="scroll-btn scroll-btn-right" onclick="scrollRightAction('skills')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9,18 15,12 9,6"></polyline>
          </svg>
        </button>
      </div>
    </div>

    <!-- Courses -->
    <div>
      <div class="section-header">Courses</div>
      <div class="relative flex items-center">
        <button class="scroll-btn scroll-btn-left" onclick="scrollLeftAction('courses')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"></polyline>
          </svg>
        </button>
        <div id="courses"
          class="flex overflow-x-auto space-x-2 sm:space-x-4 scrollbar-hide w-full mx-auto transition-all duration-300 justify-start py-4">
          {{ range .Site.Params.homepage.resume.courses }}
          <div
            class="flex-shrink-0 w-64 max-w-xs sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/5 2xl:w-1/6 text-center cursor-default course-card transition-all duration-300 ease-in-out">
            <div class="image-container">
              <img src="{{.image}}" alt="{{.name}} Image">
            </div>
            <div class="my-1 font-bold leading-tight text-base sm:text-lg md:text-xl lg:text-lg xl:text-base">{{.name}}
            </div>
            <p class="my-1 font-light text-sm leading-tight">by {{.provider}}</p>
            <p class="text-gray-500 my-1">{{.duration}}</p>
            <div class="mt-2 text-sm text-left mx-auto max-w-xs">{{ .details | safeHTML }}</div>
          </div>
          {{ end }}
        </div>
        <button class="scroll-btn scroll-btn-right" onclick="scrollRightAction('courses')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9,18 15,12 9,6"></polyline>
          </svg>
        </button>
      </div>
    </div>
  </div>
</section>

<!-- Modal JS ist bereits in /assets/js/popup.js vorhanden und wird eingebunden. -->

<script>
  function scrollLeftAction(id) {
    const container = document.getElementById(id);
    const firstChildWidth = container.children[0]?.offsetWidth || 0;

    if (container.scrollLeft <= 10) {
      container.scrollTo({ left: container.scrollWidth, behavior: 'smooth' });
    } else {
      container.scrollBy({ left: -firstChildWidth, behavior: 'smooth' });
    }
    
    // Update button states after scroll
    setTimeout(() => {
      const leftBtn = container.parentElement.querySelector('.scroll-btn-left');
      const rightBtn = container.parentElement.querySelector('.scroll-btn-right');
      if (leftBtn && rightBtn) {
        updateScrollButtonStates(container, leftBtn, rightBtn);
      }
    }, 100);
  }

  function scrollRightAction(id) {
    const container = document.getElementById(id);
    const firstChildWidth = container.children[0]?.offsetWidth || 0;

    if (container.scrollLeft + container.clientWidth >= container.scrollWidth - 10) {
      container.scrollTo({ left: 0, behavior: 'smooth' });
    } else {
      container.scrollBy({ left: firstChildWidth, behavior: 'smooth' });
    }
    
    // Update button states after scroll
    setTimeout(() => {
      const leftBtn = container.parentElement.querySelector('.scroll-btn-left');
      const rightBtn = container.parentElement.querySelector('.scroll-btn-right');
      if (leftBtn && rightBtn) {
        updateScrollButtonStates(container, leftBtn, rightBtn);
      }
    }, 100);
  }

  function updateScrollButtonStates(container, leftBtn, rightBtn) {
    const scrollLeft = container.scrollLeft;
    const maxScrollLeft = container.scrollWidth - container.clientWidth;
    
    // Left button: disable if at the beginning
    if (scrollLeft <= 0) {
      leftBtn.style.opacity = '0.5';
      leftBtn.style.cursor = 'not-allowed';
    } else {
      leftBtn.style.opacity = '1';
      leftBtn.style.cursor = 'pointer';
    }
    
    // Right button: disable if at the end
    if (scrollLeft >= maxScrollLeft - 1) {
      rightBtn.style.opacity = '0.5';
      rightBtn.style.cursor = 'not-allowed';
    } else {
      rightBtn.style.opacity = '1';
      rightBtn.style.cursor = 'pointer';
    }
  }

  function updateScrollIcons() {
    ['work', 'skills', 'courses'].forEach(id => {
      const container = document.getElementById(id);
      if (!container) return;

      const leftBtn = container.parentElement.querySelector('.scroll-btn-left');
      const rightBtn = container.parentElement.querySelector('.scroll-btn-right');

      if (container.scrollWidth > container.clientWidth + 10) {
        if (leftBtn) leftBtn.style.display = 'flex';
        if (rightBtn) rightBtn.style.display = 'flex';
        container.classList.remove('justify-center');
        container.classList.add('justify-start');
        
        // Update button states
        if (leftBtn && rightBtn) {
          updateScrollButtonStates(container, leftBtn, rightBtn);
        }
      } else {
        if (leftBtn) leftBtn.style.display = 'none';
        if (rightBtn) rightBtn.style.display = 'none';
        container.classList.remove('justify-start');
        container.classList.add('justify-center');
      }
    });
  }

  window.addEventListener('resize', updateScrollIcons);
  document.addEventListener('DOMContentLoaded', function() {
    updateScrollIcons();
    
    // Add scroll event listeners to update button states
    ['work', 'skills', 'courses'].forEach(id => {
      const container = document.getElementById(id);
      if (container) {
        container.addEventListener('scroll', () => {
          const leftBtn = container.parentElement.querySelector('.scroll-btn-left');
          const rightBtn = container.parentElement.querySelector('.scroll-btn-right');
          if (leftBtn && rightBtn) {
            updateScrollButtonStates(container, leftBtn, rightBtn);
          }
        });
      }
    });
  });
</script>

<style>
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  .scrollbar-hide {
    -ms-overflow-style: none;
    /* IE and Edge */
    scrollbar-width: none;
    /* Firefox */
  }

  .image-container {
    width: 150px;
    height: 150px;
    display: flex;
    align-items: center;
    justify-content: center;
    /* Optional: Background color for non-square images */
    overflow: hidden;
    margin-left: auto;
    margin-right: auto;
    border-radius: 20px;
  }

  .image-container img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  @media (max-width: 768px) {
    .relative>button {
      display: none;
    }

    .space-x-4> :not([hidden])~ :not([hidden]) {
      margin-left: 0.5rem !important;
      margin-right: 0.5rem !important;
    }

    .space-x-2> :not([hidden])~ :not([hidden]) {
      margin-left: 0.1rem !important;
      margin-right: 0.1rem !important;
    }

    .image-container {
      width: 80px;
      /* Noch kleinere Breite für sehr kleine Geräte */
      height: 80px;
      /* Noch kleinere Höhe für sehr kleine Geräte */
    }

    .max-w-xs {
      max-width: 30vw !important;
      padding-right: 7px;
      padding-left: 7px;
    }

    .resume-entry {
      margin-left: 7px !important;
      margin-right: 7px !important;
    }
  }
</style>